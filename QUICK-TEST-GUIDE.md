# Âø´ÈÄüÊ∏¨Ë©¶Ê???

?¨Ê??óÂπ´?©‰?Âø´ÈÄüÈ?ÂßãÊ∏¨Ë©?Excel Tools ÁØÄÈªûÁ? AI Agent ?üËÉΩ??

## Âø´ÈÄüÈ?Âß?

### 1. ÂÆâË?‰æùË≥¥

```bash
npm install
```

### 2. ?∑Ë??Ä?âÊ∏¨Ë©?

```bash
npm test
```

### 3. ?•Á?Ê∏¨Ë©¶Ë¶ÜË???

```bash
npm run test:coverage
```

## Ê∏¨Ë©¶?Ω‰ª§?üÊü•Ë°?

| ?Ω‰ª§ | Ë™™Ê? |
|------|------|
| `npm test` | ?∑Ë??Ä?âÊ∏¨Ë©?|
| `npm run test:unit` | ?™Âü∑Ë°åÂü∫Á§éÂ??ΩÊ∏¨Ë©?|
| `npm run test:ai` | ?™Âü∑Ë°?AI Agent Ê∏¨Ë©¶ |
| `npm run test:watch` | ???Ê®°Â?ÔºàËá™?ïÈ??∞Âü∑Ë°åÔ? |
| `npm run test:coverage` | ?üÊ?Ë¶ÜË??áÂ†±??|
| `npm run test:verbose` | Ë©≥Á¥∞Ëº∏Âá∫Ê®°Â? |

## Ê∏¨Ë©¶?á‰ª∂Ë™™Ê?

```
nodes/ExcelAI/
?ú‚??Ä ExcelAI.node.test.ts       ???∫Á??üËÉΩ + AI ?¥Â?Ê∏¨Ë©¶
?î‚??Ä ExcelAI.ai-agent.test.ts   ??AI Agent ?≤È??¥ÊôØÊ∏¨Ë©¶
```

## Ê∏¨Ë©¶Ê∂µË?ÁØÑÂ?

### ??AI Agent ?¥Â?Ê∏¨Ë©¶
- ?™ÁÑ∂Ë™ûË??ÉÊï∏?ïÁ?
- ?πÊ¨°?ç‰?
- Ê∏ÖÊô∞?ØË™§Ë®äÊÅØ

### ???™ÁÑ∂Ë™ûË?Ëº∏ÂÖ•Ê∏¨Ë©¶
- ‰∏≠Ê??™ÁÑ∂Ë™ûË??èËø∞
- Ê®°Á??•Ê??ÇÈ?Ôºà‰?Â§©„ÄÅ‰??±„ÄÅÊ?Âπ¥Ô?
- Â§öË?Ë®ÄÊ∑∑Â?Ôºà‰∏≠?±Êó•?áÔ?
- ?∏Â??∏È?ÔºàÂπæ?ã„ÄÅÂ?Â§ö„ÄÅÂ??èÔ?
- Ê¢ù‰ª∂?èËºØË°®È?

### ???ïÊ?Ê¨Ñ‰??†Â?Ê∏¨Ë©¶
- Â§öÁ®Æ?ΩÂ????Ôºàsnake_case?ÅcamelCase Á≠âÔ?
- ÂµåÂ??©‰ª∂?ÅÂπ≥??
- ?∫ËÉΩÈ°ûÂ?ËΩâÊ?
- Ê¨Ñ‰??åÁæ©Ë©ûÂ???
- ????ºË???
- Áº∫Â§±Ê¨Ñ‰?Â°´Â?

### ???ØË™§?ïÁ?Ê∏¨Ë©¶
- ?á‰ª∂/Â∑•‰?Ë°®‰?Â≠òÂú®
- ?°Ê? JSON ?ºÂ?
- Ê¨äÈ??èÈ?
- ‰∏¶ÁôºÂ≠òÂ?
- continueOnFail Ê®°Â?
- Ë©≥Á¥∞?ØË™§Ë®äÊÅØ

### ??Ë§áÈ?Â∑•‰?ÊµÅÁ?Ê∏¨Ë©¶
- Â§öÊ≠•È©üË???
- ‰∏ä‰??áÊ±∫Á≠?
- ?πÊ¨°?∫ËÉΩ?ïÁ?
- Ê¢ù‰ª∂?ç‰???

### ???àËÉΩÊ∏¨Ë©¶
- Â§ßÈ??∏Ê?ËÆÄ?ñÔ?1000+ Á≠ÜÔ?
- ÊµÅÂ??ïÁ?
- Âø´Â?Ê©üÂà∂

## ÁØÑ‰?Ê∏¨Ë©¶Ê°à‰?

### ?™ÁÑ∂Ë™ûË?Ëº∏ÂÖ•

```typescript
// Ê∏¨Ë©¶ÔºöAI Agent ?ê‰?‰∏≠Ê??èËø∞
const input = `Ë´ãÊ∑ª?†‰?Á≠ÜÂì°Â∑•Ë??ÑÔ?
  ÂßìÂ??ØÂºµÂ∞èÊ?ÔºåÂπ¥ÈΩ°ÊòØ28Ê≠≤Ô??®È??ØÁ??ºÈÉ®`;

// AI Ëß???∫Á?ÊßãÂ??∏Ê?
const parsed = {
  ÂßìÂ?: 'ÂºµÂ???,
  Âπ¥ÈΩ°: 28,
  ?®È?: '?îÁôº??
};
```

### ?ïÊ?Ê¨Ñ‰??†Â?

```typescript
// Ê∏¨Ë©¶Ôºö‰??åÂëΩ?çÈ¢®?ºËá™?ïÂ?ÈΩ?
const inputs = [
  { snake_case_field: 'value' },
  { camelCaseField: 'value' },
  { ‰∏≠Ê?Ê¨Ñ‰?: 'value' }
];
// ?Ä?âÊ†ºÂºèÈÉΩ?ΩÊ≠£Á¢∫Ë???
```

### ?ØË™§?ïÁ?

```typescript
// Ê∏¨Ë©¶ÔºöcontinueOnFail Ê®°Â?
const results = [
  { success: true },   // Á¨¨‰?Á≠ÜÊ???
  { error: '...' },    // Á¨¨‰?Á≠ÜÂ§±??
  { success: true }    // Á¨¨‰?Á≠ÜÁπºÁ∫åÂü∑Ë°?
];
```

## ?•Á?Ê∏¨Ë©¶ÁµêÊ?

### ÁµÇÁ´ØÊ©üËº∏??

```bash
PASS  nodes/ExcelAI/ExcelAI.node.test.ts
  ??AI Agent Integration Tests (5)
  ??Natural Language Input Tests (5)
  ??Dynamic Field Mapping Tests (6)
  ??Error Handling Tests (13)
  ??Integration Tests (2)

Test Suites: 2 passed, 2 total
Tests:       45 passed, 45 total
```

### Ë¶ÜË??áÂ†±??

?∑Ë? `npm run test:coverage` ÂæåÔ??ìÈ? `coverage/lcov-report/index.html` ?•Á?Ë©≥Á¥∞?±Â???

## Ê∏¨Ë©¶Â§±Ê??éÈ∫ºËæ¶Ô?

### Step 1: ?•Á?Ë©≥Á¥∞?ØË™§

```bash
npm run test:verbose
```

### Step 2: ?∑Ë??Æ‰?Ê∏¨Ë©¶?á‰ª∂

```bash
npx jest ExcelAI.node.test.ts
```

### Step 3: ?∑Ë??πÂ?Ê∏¨Ë©¶Ê°à‰?

```bash
npx jest -t "?âË©≤?ïÁ? AI Agent"
```

### Step 4: ?§ÈåØÊ®°Â?

```bash
node --inspect-brk node_modules/.bin/jest --runInBand
```

## ?∞Â?Ê∏¨Ë©¶

### 1. ?∏Ê?Ê≠?¢∫?ÑÊ∏¨Ë©¶Ê?‰ª?

- **?∫Á??üËÉΩ/Á∞°ÂñÆ?¥Â?** ??`ExcelAI.node.test.ts`
- **AI Agent ?≤È??¥ÊôØ** ??`ExcelAI.ai-agent.test.ts`

### 2. Á∑®ÂØ´Ê∏¨Ë©¶

```typescript
test('?âË©≤?ïÁ??∞Â???, async () => {
  // Arrange - Ë®≠Â?
  mockContext.getNodeParameter.mockImplementation(...);
  
  // Act - ?∑Ë?
  const result = await excelCrud.execute.call(mockContext);
  
  // Assert - È©óË?
  expect(result).toBeDefined();
  expect(result[0].json.success).toBe(true);
});
```

### 3. ?∑Ë?Ê∏¨Ë©¶

```bash
npm test
```

## ?àËÉΩ?∫Ê?

| ?ç‰? | ?∏Ê???| ?êÊ??ÇÈ? |
|------|--------|----------|
| ËÆÄ??| 1000 Á≠?| < 5 Áß?|
| ?µÂª∫ | 100 Á≠?| < 2 Áß?|
| ?¥Êñ∞ | 100 Á≠?| < 2 Áß?|
| ?™Èô§ | 100 Á≠?| < 1 Áß?|

## Â∏∏Ë??èÈ?

### Q: ?∫‰?È∫ºË??ÜÂÖ©?ãÊ∏¨Ë©¶Ê?‰ª∂Ô?

A: `node.test.ts` Â∞àÊ≥®?∫Á??üËÉΩÊ∏¨Ë©¶Ôºå`ai-agent.test.ts` Â∞àÊ≥® AI Agent ?πÊ??¥ÊôØÔºåË?Ê∏¨Ë©¶?¥Ê?ÁµÑÁ??ß„Ä?

### Q: Â¶Ç‰?Ê∏¨Ë©¶?πÂ??¥ÊôØÔº?

A: ‰ΩøÁî® `-t` ?ÉÊï∏Ôº?
```bash
npx jest -t "?™ÁÑ∂Ë™ûË?"
```

### Q: Ê∏¨Ë©¶Â§™ÊÖ¢?éÈ∫ºËæ¶Ô?

A: ?Ø‰ª•‰ΩøÁî® `--maxWorkers` ?êÂà∂‰∏¶Ë??∏Ô?
```bash
npm test -- --maxWorkers=2
```

## ‰∏ã‰?Ê≠?

- ?? ?±Ë? [ÂÆåÊï¥Ê∏¨Ë©¶?áÊ?](./AI-AGENT-TESTING.md)
- ?? ?±Ë? [?ãÁôºÊ∏¨Ë©¶?áÂ?](./TESTING.md)
- ?îß ?•Á? [ÁØÄÈªûÂØ¶‰Ωú](./nodes/ExcelAI/ExcelAI.node.ts)
- ?? ?ÉËÄ?[README](./README.zh-TW.md)

## ?ÄË¶ÅÂπ´?©Ô?

- ?ìß ?ê‰∫§ Issue
- ?í¨ ?†ÂÖ•Ë®éË?
- ?? ?•Á??áÊ?

---

**?êÁ§∫**: ‰ΩøÁî® `npm run test:watch` ?®È??ºÊ??™Â??∑Ë?Ê∏¨Ë©¶ÔºåÊ?È´òÈ??ºÊ??áÔ?

